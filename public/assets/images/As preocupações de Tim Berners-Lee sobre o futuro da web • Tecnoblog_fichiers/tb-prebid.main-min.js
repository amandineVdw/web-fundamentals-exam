window.TBPrebidMain=()=>{window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],window.pbjs=window.pbjs||{que:[]};const{options:e,initialMedia:i}=window.TBPrebidConfig||{};let{adSlots:t,otherSlots:n}=window.TBPrebidConfig||{};const o=e.currentPage||null;let s,d=!1,r=!0,l=[],a=!1,c=[],u=[],g=[],f=!1,b=!1,p=!1,m=[],h=!1;const w={},v={prebid:!1,gpt:!1},y=()=>"interactive"==document.readyState||"complete"==document.readyState,S=e=>{y()?e():l.push(e)};document.addEventListener("DOMContentLoaded",(()=>{if(l.length>0){let e=null;for(;e=l.shift();)"function"==typeof e&&e()}}),{passive:!0});const E=()=>{E.enabled};function T(i){S((()=>{var e;(e=i,new Promise((i=>{let t="",n="";for(var o=e.length;o--;){let i=e[o];t=document.querySelector(i.container),t?(n=document.createElement("div"),n.setAttribute("id",i.code),t.innerHTML="",t.appendChild(n),i.isSlotBiddable=!0):e.splice(o,1)}i(e)}))).then((e=>L.register(e))).catch((e=>E.error(e)))})),I.register(i),s=setTimeout((function(){P()}),e.firstBidTimeout)}E.info=function(){E.enabled},E.warn=function(){E.enabled},E.error=function(){E.enabled},E.enabled=~document.location.hash.indexOf("debug"),E.prefix="TB-Prebid";const I={settings(){I.enqueuePrebid((()=>{E.info(`Prebid inicializado. Versao: ${pbjs.version}`);let i={enableTIDs:!0,useBidCache:!0,bidderSequence:"random",priceGranularity:"high",enableSendAllBids:!1,bidderTimeout:e.biddersTimeout,timeoutBuffer:300,gptPreAuction:{enabled:!0},performanceMetrics:!1,bidViewability:{enabled:!0,firePixels:!0},currency:{adServerCurrency:"USD"},userSync:{syncDelay:3e3,iframeEnabled:!0,syncsPerBidder:3,filterSettings:{iframe:{bidders:["appnexus","medianet","smartadserver","rubicon","teads"],filter:"include"}},userIds:[{name:"sharedId",params:{pixelUrl:"/wp-json/pubcid/v1/extend/"},storage:{type:"cookie",name:"_sharedid",expires:365}}]}};if(pbjs.setConfig(i),e.prebid.bidderCpmMultipliers){let i=pbjs.bidderSettings||{};for(let t in e.prebid.bidderCpmMultipliers){let n=e.prebid.bidderCpmMultipliers[t],o=i[t]||{};o.bidCpmAdjustment=e=>{let i=e*n;return E.info("Prebid.bicCpmAdjustment:",t,`$${e.toFixed(3)} => $${i.toFixed(3)}`),i},i[t]=o}pbjs.bidderSettings=i}pbjs.bidderSettings.standard={storageAllowed:!0}}))},register(e){let i=[],t=[];e.forEach((e=>{if(!e.prebid)return;if(o&&e.page&&!e.page.includes(o))return;let n=[];for(let i=0;i<e.sizes.length;i++){let t=e.sizes[i];Array.isArray(t)&&!~t.indexOf("fluid")&&n.push(t)}let s={code:e.code,mediaTypes:e.mediaTypes?e.mediaTypes:{banner:{sizes:n}},bids:e.prebid&&e.prebid.bids?e.prebid.bids:[]};i.push(s),t.push(e.code)})),I.enqueuePrebid((()=>{E.info("Registrando slots no Prebid:",t),pbjs.addAdUnits(i)})),I.requestBids(t)},requestBids(e){e&&e.length&&I.enqueuePrebid((()=>{E.info("Prebid.requestBids:",e),pbjs.requestBids({adUnitCodes:e,bidsBackHandler:i=>{L.enqueueGpt((()=>{pbjs.setTargetingForGPTAsync(e),E.info("Resposta de bids prebid recebida. Aguardando AdServer da Google...",i),v.prebid=!0,function(e){E.info("biddersBack "+e),!v.prebid||P()}("prebid")}))}})}))},enqueuePrebid(e){window.pbjs.que.push(e)}},L={settings(){L.enqueueGpt((()=>{E.info(`GPT inicializado. Versao: ${googletag.getVersion()}`);const i=googletag.pubads(),t=e.gpt;i.disableInitialLoad(),i.enableSingleRequest(),i.setCentering(t.centering),i.setForceSafeFrame(t.forceSafeFrame),t.lazyLoad&&i.enableLazyLoad(t.lazyLoad),googletag.enableServices(),i.addEventListener("impressionViewable",(e=>{j.impressionViewed(e)}),{passive:!0}),i.addEventListener("slotVisibilityChanged",(i=>{j.gptSlotViewability(i,e.minViewabilityPercent)}),{passive:!0}),i.addEventListener("slotRenderEnded",(function(e){j.slotRenderEnded(e)}),{passive:!0}),i.addEventListener("slotRequested",(function(e){E.info("Fetched ",e.slot.getSlotElementId())})),i.addEventListener("slotOnload",(function(e){E.info("Rendered ",e.slot.getSlotElementId())}))}))},register(i){L.enqueueGpt((()=>{i.forEach((i=>{if(!i.isSlotBiddable)return;if(o&&i.page&&!i.page.includes(o))return;E.info("Registrando slot no GPT:",i.code);let t=googletag.defineSlot(i.block,i.sizes,i.code);if(null==t)return E.warn("GPT retornou slot como null:",i.code);t.addService(googletag.pubads()),e.targeting&&t.setTargeting("tb_categoria",e.targeting),E.info("GPT.display:",i.code),googletag.display(t),i.gptSlot=t}))}))},enqueueGpt(e){googletag.cmd.push(e)}},B={settings(){n&&n.register&&n.display&&L.enqueueGpt((()=>{E.info("Registrando slots custom..."),n.register(googletag),E.info("Exibindo slots custom..."),n.display(googletag)}))}};function P(){if(!v.gpt){if(v.gpt=!0,E.info("Request AdServer Google",P.caller),r)clearTimeout(s),q(),r=!1,c.length>0&&(T(c),t=[...t,...c]);else if(c.length>0){clearTimeout(s),q(c.map((e=>e.gptSlot))),c=[]}else clearTimeout(p),p=!1,u.forEach((e=>{m.push(e.code),E.info("Colocando na fila de refresh ",m)})),u=[],function(){if(0==m.length)return;if(h)return;h=!0;let e=[],i=[];t.forEach((t=>{m.includes(t.code)&&(t.inView&&(E.info("refresh... ",t.code),t.inView=!1),e.push(t.gptSlot),i.push(t.code),function(e){let i=document.getElementById(e);i&&(i.innerHTML="")}(t.code))})),e.length>0&&(q(e),m=m.filter((e=>!i.includes(e))),w&&w.observerList&&i.forEach((e=>function(e){window.IntersectionObserver&&w.observerList.includes(e)&&(w.observer.unobserve(document.getElementById(e)),w.observerList=w.observerList.filter((i=>i!=e)))}(e))));h=!1}(),clearTimeout(f),f=!1,b=!1,g.length>0&&(E.info("Slots que ficaram na fila para receberam bids serÃ£o processados"),g.forEach((e=>{m.includes(e.code)||C(e)})),g=[]);v.prebid=!1,v.gpt=!1}}function q(e){L.enqueueGpt((()=>{E.info("Refresh: ",e),googletag.pubads().refresh(e)}))}function V(i,n=e.timeoutRefresh){let o=t.find((e=>e.code===i));o&&(o.bidRefreshTimer||(E.info("Start do timer para entrar na fila de bid ",i),o.bidRefreshTimer=new A((()=>C(o)),n,i)))}function C(i){if(!u.includes(i))if(delete i.bidRefreshTimer,b)E.info("Slot na fila de espera de bid ",i),g.push(i);else if(E.info("Slot na fila de bid ",i),u.push(i),!f){let i;f=setTimeout((()=>{b=!0,E.info("Fila de bid vai ser processada com "+u.length+" slots ",u),i=u.map((e=>e.code)),I.requestBids(i),g&&(g=g.filter((e=>!u.includes(e))),E.info("biddableSlotstemp",g)),p||(p=setTimeout((function(){E.info("Timeout dos bidders"),P()}),e.bidRefreshTimeout))}),200)}}function R(e){const i=document.getElementById(e);if(i)if(window.IntersectionObserver){function n(e,i){let n=t.find((i=>i.code===e));n.inView=i,E.info(e+" in view (custom): "+n.inView)}w.observerList||(w.observerList=[]),w.observerList.push(e),w.observer||(w.observer=new window.IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?n(e.target.id,!0):n(e.target.id,!1)}))}),{root:null})),E.info("Start custom inView observer ",e),w.observer.observe(i)}else slot.inView=!0}d||(d=!0,E.info("Inicializando TB Prebid com as opcoes:",e),L.settings(),I.settings(),!y()&&o&&(a=!0),T(t),B.settings());const j={impressionViewed(e){E.info("Impressao exibida:",e.slot.getSlotElementId()),V(e.slot.getSlotElementId())},gptSlotViewability(e,i){let n=t.find((i=>i.code===e.slot.getSlotElementId()));n.inView=e.inViewPercentage>0,E.info(n.code+" in view: "+n.inView)},slotRenderEnded(i){E.info("Finished rendering isEmpty "+i.isEmpty,i.slot.getSlotElementId());let t=!1;i.isEmpty?(V(i.slot.getSlotElementId()),R(i.slot.getSlotElementId())):2833040804==i.campaignId&&(V(i.slot.getSlotElementId(),e.timeoutRefreshCustom),R(i.slot.getSlotElementId()),t=!0),"div-gpt-ad-1565989183597-0"==i.slot.getSlotElementId()&&function(e,i,t){let n=document.querySelector(`#${i}`).closest("#ad-mobile-sticky-container").parentElement;n&&e||t?n.classList.add("empty"):!e&&n.classList.contains("empty")&&n.classList.remove("empty")}(i.isEmpty,i.slot.getSlotElementId(),t)}};const A=function(e,i,t){let n,o,s;s=void 0,o=void 0,n=i,this.running=!1,this.finished=!1,this.resume=function(){this.finished||this.running||(o=new Date,window.clearTimeout(s),s=window.setTimeout(e,n),E.info(">>>>>>>>>>> Ativando timer "+t+" com "+n),this.running=!0)},this.resume()};S((()=>{var e,i,t,n=!1;function o(){window.innerWidth<744?(e=0,i=document.getElementById("ad-mobile-sticky-container"),t=document.getElementById("ad-mobile-sticky-button")):(e=300,i=document.getElementById("ad-desktop-sticky-container"),t=document.getElementById("ad-desktop-sticky-button"))}o(),window.onresize=o,t&&i&&(t.addEventListener("click",(function(e){i.classList.toggle("show")})),document.addEventListener("scroll",(()=>{var t=window.scrollY;!1===n&&t>e?(i.classList.add("show"),n=!0):!1!==n&&t<e&&(i.classList.remove("show"),n=!1)})))}))},window.TBPrebidConfig&&window.TBPrebidMain();